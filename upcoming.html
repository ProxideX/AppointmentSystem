<!-- File: upcoming.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Upcoming Appointments - Uni Bookings</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #1c1c1c;
      padding: 24px;
    }
    /* Back button */
    #backBtn {
      background-color: #00aaff;
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 4px;
      margin-bottom: 16px;
    }
    #backBtn:hover {
      background-color: #14214e;
    }
    h2 {
      margin-bottom: 16px;
      color: white;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: #444;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    th, td {
      padding: 12px;
      border: 1px solid #444;
      text-align: left;
      color: white;
    }
    th {
      background: #1c1c1c;
      color: #bbb;
    }
    button {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .view-btn {
      background: #1c1c1c;
      color: #fff;
    }
    .doc-link {
      color: #10B981;
      text-decoration: underline;
      cursor: pointer;
    }
    .fade-out {
      opacity: 0;
      transition: opacity 0.5s ease-out;
    }
  </style>
</head>
<body>

  <button id="backBtn">Go back to homepage</button>

  <h2>Upcoming Appointments</h2>

  <table>
    <thead>
      <tr>
        <th>No.</th>
        <th>Student</th>
        <th>Date</th>
        <th>Time</th>
        <th>Notes</th>
        <th>Documents</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="appointments-body">
      <tr>
        <td>1</td>
        <td>Danish</td>
        <td>2/5/2025</td>
        <td>
          4:00pm – 6:00pm&nbsp;
          <button class="view-btn" onclick="changeTime(this)">Change</button>
        </td>
        <td>Discuss final year project progress</td>
        <td>
          <a class="doc-link"
             href="[VERIFIED] Diploma - CIT4224 Internet and Web PublishingTeaching Plan.pdf"
             target="_blank">View Document</a>
        </td>
        <td>
          <button class="view-btn" onclick="deleteAppointment(this)">Delete</button>
        </td>
      </tr>
      <tr>
        <td>2</td>
        <td>Wellson</td>
        <td>2/5/2025</td>
        <td>
          10:00am – 12:00pm&nbsp;
          <button class="view-btn" onclick="changeTime(this)">Change</button>
        </td>
        <td>Discuss final year project progress</td>
        <td>
          <a class="doc-link"
             href="[VERIFIED] Diploma - CIT4224 Internet and Web PublishingTeaching Plan.pdf"
             target="_blank">View Document</a>
        </td>
        <td>
          <button class="view-btn" onclick="deleteAppointment(this)">Delete</button>
        </td>
      </tr>
      <!-- Hidden "No appointments" row -->
      <tr id="empty-message" style="display: none;">
        <td colspan="7" style="text-align:center; color: #bbb;">
          There are currently no appointments.
        </td>
      </tr>
      <!-- Repeat rows as needed -->
    </tbody>
  </table>

  <script>
    // Go back to homepage
    document.getElementById('backBtn').addEventListener('click', () => {
      if (confirm('Are you sure you want to go back to the homepage?')) {
        window.location.href = 'lecturer.html';
      }
    });

    function deleteAppointment(button) {
      if (confirm('Are you sure you want to delete this appointment?')) {
        const row = button.closest('tr');
        row.classList.add('fade-out');
        setTimeout(() => {
          row.remove();
          const tbody = document.getElementById('appointments-body');
          const rows = tbody.querySelectorAll('tr:not(#empty-message)');
          rows.forEach((tr, index) => {
            tr.querySelector('td').textContent = index + 1;
          });
          if (rows.length === 0) {
            document.getElementById('empty-message').style.display = '';
          }
        }, 500);
      }
    }

    function changeTime(button) {
      const cell = button.parentElement;
      if (cell.querySelector('input[type="time"]')) return;
      const originalText = cell.childNodes[0].textContent.trim();
      cell.innerHTML = originalText + ' ';
      const startInput = document.createElement('input');
      startInput.type = 'time';
      startInput.style.marginRight = '4px';
      const endInput = document.createElement('input');
      endInput.type = 'time';
      endInput.style.marginRight = '4px';
      const saveBtn = document.createElement('button');
      saveBtn.textContent = 'Save';
      saveBtn.style.cssText = 'background:#10B981;color:white;border:none;padding:4px 8px;margin-right:4px;border-radius:4px;cursor:pointer;';
      const cancelBtn = document.createElement('button');
      cancelBtn.textContent = 'Cancel';
      cancelBtn.style.cssText = 'background:#EF4444;color:white;border:none;padding:4px 8px;margin-right:4px;border-radius:4px;cursor:pointer;';
      cell.append(startInput, document.createTextNode(' – '), endInput, saveBtn, cancelBtn);
      startInput.focus();

      saveBtn.onclick = () => {
        if (!startInput.value || !endInput.value) {
          alert('Please select both start and end time.');
          return;
        }
        if (startInput.value >= endInput.value) {
          alert('End time must be later than start time.');
          return;
        }
        const fmt = t => {
          let [h, m] = t.split(':');
          h = parseInt(h);
          const ap = h >= 12 ? 'pm' : 'am';
          h = h % 12 || 12;
          return `${h}:${m}${ap}`;
        };
        cell.innerHTML = `${fmt(startInput.value)} – ${fmt(endInput.value)} `;
        const change = document.createElement('button');
        change.textContent = 'Change';
        change.className = 'view-btn';
        change.onclick = () => changeTime(change);
        cell.append(change);
      };

      cancelBtn.onclick = () => {
        cell.innerHTML = originalText + ' ';
        const change = document.createElement('button');
        change.textContent = 'Change';
        change.className = 'view-btn';
        change.onclick = () => changeTime(change);
        cell.append(change);
      };
    }
  </script>

</body>
</html>
